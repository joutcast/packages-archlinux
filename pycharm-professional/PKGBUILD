# $Id: pkgbuild-mode.el,v 1.23 2007/10/20 16:02:14 juergen Exp $
# Contributor: Sergey Mastykov <smastykov[at]gmail[dot]com>
# Contributor: Dave Pretty <david.pretty[at]gmail[dot]com>
# Contributor: Steven Thomas <SoonerBourne34[at]gmail[dot]com>

pkgname=pycharm-professional
pkgver=3.0.2
pkgrel=1.2
pkgdesc="Powerful Python and Django IDE. Professional version."
arch=('any')
options=('!strip')
url="http://www.jetbrains.com/pycharm/"
conflicts=('pycharm')
provides=('pycharm')
license=('Commercial')
depends=('java-runtime>=6')
source=(http://download.jetbrains.com/python/$pkgname-$pkgver.tar.gz)
sha256sums=('629ca4120c1490140e0466848ab5701db1622250d12b6b17f4ab6b2768279c76')

package() {
  cd $srcdir
  mkdir -p $pkgdir/opt/$pkgname || return 1
  cp -R $srcdir/pycharm-$pkgver/* $pkgdir/opt/$pkgname || return 1
  if [[ $CARCH = 'i686' ]]; then
          rm -f $pkgdir/opt/$pkgname/bin/libyjpagent-linux64.so
          rm -f $pkgdir/opt/$pkgname/bin/fsnotifier64
          echo '-Dawt.useSystemAAFontSettings=on' >> $pkgdir/opt/$pkgname/bin/pycharm.vmoptions
          echo '-Dswing.aatext=true' >> $pkgdir/opt/$pkgname/bin/pycharm.vmoptions
     else
    echo '-Dawt.useSystemAAFontSettings=on' >> $pkgdir/opt/$pkgname/bin/pycharm64.vmoptions
          echo '-Dswing.aatext=true' >> $pkgdir/opt/$pkgname/bin/pycharm64.vmoptions 
  fi

(
cat <<EOF
[Desktop Entry]
Version=$pkgver
Name=PyCharm
Icon=pycharm
GenericName=Develop with pleasure!
Comment=Powerful Python and Django IDE 30-day free trial
Exec=/opt/$pkgname/bin/pycharm.sh
Terminal=false
Type=Application
Categories=Development
EOF
) > $startdir/pycharm.desktop

  mkdir -p $pkgdir/usr/share/applications/ || return 1
  mkdir -p $pkgdir/usr/share/pixmaps/ || return 1
  mkdir -p $pkgdir/usr/share/licenses/$pkgname/ || return 1
  mkdir -p $pkgdir/usr/bin/ || return 1
  install -Dm644 $startdir/pycharm.desktop $pkgdir/usr/share/applications/
  install -Dm644 $pkgdir/opt/$pkgname/bin/pycharm.png $pkgdir/usr/share/pixmaps/pycharm.png
  install -Dm644 $srcdir/pycharm-$pkgver/license/PyCharm_license.txt $pkgdir/usr/share/licenses/$pkgname/PyCharm_license.txt
  cd $pkgdir
  ln -s /opt/$pkgname/bin/pycharm.sh usr/bin

}

# vim:set ts=2 sw=2 et:
